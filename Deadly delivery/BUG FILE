-- Infinity Stamina - Direct Active (No consumption at all)
-- Stamina will never decrease and always stay full

local ReplicatedStorage = game:GetService("ReplicatedStorage")
local RunService = game:GetService("RunService")
local Players = game:GetService("Players")

print("‚è≥ Loading Infinity Stamina...")
task.wait(1)

-- Load required modules
local Value = require(ReplicatedStorage.Shared.Core.Value)
local Config = require(ReplicatedStorage.Config)

-- Get max stamina value
local maxStamina = Config.Property.StaminaSystem.stamina.default

print("üìä Max Stamina:", maxStamina)
print("üîß Activating Infinity Stamina...")

-- Set initial stamina to max
Value.Stamina = maxStamina

-- ===== STEP 1: SET CONSUMPTION TO ZERO =====
Config.Property.StaminaSystem.runStaminaConsume = 0
Value.StaminaConsumeMutil = 0

print("‚úì Stamina consumption set to 0")

-- ===== STEP 2: SET SUPER FAST REGEN =====
Config.Property.StaminaSystem.naturalRecovery = 99999
Config.Property.StaminaSystem.delayRecoveryTime = 0

print("‚úì Regen speed: 99999")
print("‚úì Regen delay: 0")

-- ===== STEP 3: KEEP STAMINA ALWAYS FULL =====
-- This ensures stamina never goes below max
local keepFullConnection = RunService.Heartbeat:Connect(function()
    if Value.Stamina < maxStamina then
        Value.Stamina = maxStamina
    end
end)

print("‚úì Auto-refill system active")

-- ===== STEP 4: HIDE STAMINA BAR =====
task.spawn(function()
    task.wait(0.5)
    local success = pcall(function()
        local StaminaFrame = Players.LocalPlayer.PlayerGui.Main.HomePage.Property.Stamina
        StaminaFrame.Visible = false
        StaminaFrame.Frame.Bar.Size = UDim2.fromScale(1, 1)
        print("‚úì Stamina bar hidden")
    end)
    if not success then
        warn("‚ö† Could not hide stamina bar (not critical)")
    end
end)

-- ===== STEP 5: OVERRIDE BUFF SYSTEM =====
task.spawn(function()
    pcall(function()
        local Buff = require(ReplicatedStorage.Shared.Features.Buff)
        
        -- Block stamina consumption buffs
        Buff.OnChanged("StaminaConsumeRate", function()
            Config.Property.StaminaSystem.runStaminaConsume = 0
            Value.StaminaConsumeMutil = 0
        end, { replay = true })
        
        -- Boost regen buffs
        Buff.OnChanged("StaminaRegenRate", function()
            Config.Property.StaminaSystem.naturalRecovery = 99999
        end, { replay = true })
        
        -- Block negative stamina changes
        Buff.OnApply("Stamina", function(arg1, arg2)
            local change = arg2:Get()
            if change < 0 then
                -- Block any negative stamina change
                Value.Stamina = maxStamina
            end
        end)
        
        print("‚úì Buff system protected")
    end)
end)

-- ===== MONITORING =====
local monitoring = true
task.spawn(function()
    local lastCheck = tick()
    while monitoring do
        task.wait(5)
        local currentTime = tick()
        local timePassed = currentTime - lastCheck
        
        print(string.format("üí™ Status: Stamina = %.0f/%d (100%%) | Uptime: %.0fs", 
            Value.Stamina, maxStamina, timePassed))
        
        lastCheck = currentTime
    end
end)

print("‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ")
print("‚úÖ INFINITY STAMINA ACTIVE!")
print("‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ")
print("")
print("Your stamina will NEVER decrease!")
print("You can run forever without stopping!")
print("")
print("Features active:")
print("  ‚úì Zero consumption")
print("  ‚úì Instant regen (99999)")
print("  ‚úì Auto-refill every frame")
print("  ‚úì Buff system protected")
print("  ‚úì Stamina bar hidden")
print("")
print("Press F9 to see status updates")
print("To disable: _G.DisableInfinity()")
print("")

-- Disable function
_G.DisableInfinity = function()
    monitoring = false
    if keepFullConnection then
        keepFullConnection:Disconnect()
    end
    print("‚ùå Infinity Stamina DISABLED")
end

print("üéÆ Ready! Go run and test it!")
