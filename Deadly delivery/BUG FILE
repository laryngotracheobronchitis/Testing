-- Infinity Stamina - Loop 5 Only (0.01s interval)
-- Single fast loop that keeps stamina always full

local ReplicatedStorage = game:GetService("ReplicatedStorage")
local Players = game:GetService("Players")

print("‚è≥ Loading Infinity Stamina (Fast Loop)...")
task.wait(1)

-- Load required modules
local Value = require(ReplicatedStorage.Shared.Core.Value)
local Config = require(ReplicatedStorage.Config)

-- Get max stamina value
local maxStamina = Config.Property.StaminaSystem.stamina.default

print("üìä Max Stamina:", maxStamina)
print("üîß Starting fast loop (0.01s interval)...")

-- Set initial stamina to max
Value.Stamina = maxStamina

-- ===== MAIN LOOP: 0.01 SECOND INTERVAL =====
local loopRunning = true
local loopCount = 0

task.spawn(function()
    while loopRunning do
        loopCount = loopCount + 1
        
        -- Force stamina to max
        Value.Stamina = maxStamina
        
        -- Set consumption to zero
        Value.StaminaConsumeMutil = 0
        Config.Property.StaminaSystem.runStaminaConsume = 0
        
        -- Set super fast regen
        Config.Property.StaminaSystem.naturalRecovery = 99999
        Config.Property.StaminaSystem.delayRecoveryTime = 0
        
        -- Wait 0.01 seconds (100 times per second)
        task.wait(0.01)
    end
end)

print("‚úì Fast loop active (runs 100x per second)")

-- ===== HIDE STAMINA BAR =====
task.spawn(function()
    task.wait(0.5)
    pcall(function()
        local StaminaFrame = Players.LocalPlayer.PlayerGui.Main.HomePage.Property.Stamina
        StaminaFrame.Visible = false
        StaminaFrame.Frame.Bar.Size = UDim2.fromScale(1, 1)
        print("‚úì Stamina bar hidden")
    end)
end)

-- ===== BUFF PROTECTION =====
task.spawn(function()
    pcall(function()
        local Buff = require(ReplicatedStorage.Shared.Features.Buff)
        
        -- Block stamina consumption buffs
        Buff.OnChanged("StaminaConsumeRate", function()
            Config.Property.StaminaSystem.runStaminaConsume = 0
            Value.StaminaConsumeMutil = 0
        end, { replay = true })
        
        -- Boost regen buffs
        Buff.OnChanged("StaminaRegenRate", function()
            Config.Property.StaminaSystem.naturalRecovery = 99999
        end, { replay = true })
        
        -- Block negative stamina changes
        Buff.OnApply("Stamina", function(arg1, arg2)
            local change = arg2:Get()
            if change < 0 then
                Value.Stamina = maxStamina
            end
        end)
        
        print("‚úì Buff system protected")
    end)
end)

-- ===== MONITORING =====
local monitoring = true
task.spawn(function()
    local lastCheck = 0
    while monitoring do
        task.wait(5)
        lastCheck = lastCheck + 1
        
        local currentStamina = Value.Stamina
        local percentage = math.floor((currentStamina / maxStamina) * 100)
        
        print(string.format("üí™ [Check #%d] Stamina: %.0f/%d (%d%%) | Loop: %d iterations", 
            lastCheck, currentStamina, maxStamina, percentage, loopCount))
    end
end)

print("‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ")
print("‚úÖ INFINITY STAMINA ACTIVE!")
print("‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ")
print("")
print("‚ö° Fast Loop Configuration:")
print("  ‚Ä¢ Interval: 0.01 seconds")
print("  ‚Ä¢ Speed: 100 updates per second")
print("  ‚Ä¢ Type: While loop with task.wait()")
print("")
print("Features:")
print("  ‚úì Stamina locked at maximum")
print("  ‚úì Zero consumption")
print("  ‚úì Instant regeneration (99999)")
print("  ‚úì Buff system protected")
print("  ‚úì Stamina bar hidden")
print("")
print("Press F9 to see status updates")
print("To disable: _G.StopLoop()")

-- Disable function
_G.StopLoop = function()
    loopRunning = false
    monitoring = false
    
    print("‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ")
    print("‚ùå LOOP STOPPED!")
    print("‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ")
    print("Total iterations:", loopCount)
    print("Infinity Stamina has been disabled")
end

print("üéÆ Loop is now running at 0.01s interval!")
print("üéÆ Your stamina will stay at 100%!")
